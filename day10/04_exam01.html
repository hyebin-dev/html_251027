<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        button>img{
            width: 150px;
            height: 150px;
        }
    </style>
</head>
<body>
    <!-- 
        가위바위보 이미지를 버튼태그에 넣어 선택하여 가위바위보의 승률 계산
    -->
    <button><img id="0" src="../image/math_img_1.jpg" alt=""></button>
    <button><img id="1" src="../image/math_img_2.jpg" alt=""></button>
    <button><img id="2" src="../image/math_img_3.jpg" alt=""></button>
    <h1 id="result"></h1>

    <!-- 
        player:가위 / com:바위 player가 졌습니다.
        현재 전적
        승:9 / 무:6 / 패:7
        승률 : 56.25%
    -->
    <script>

        document.addEventListener('click',(e)=>{
            // 모든 화면에 이벤트가 달림
            // 동적으로 생기는 모든 객체에 이벤트 추가가능
            console.log(e.target.id);
            play(e.target.id);

        })

        // 전역변수 결과변수
        //let win=0;
        //let draw=0;
        //let lose=0;

        const resultCount = {
            win:0,
            draw:0,
            lose:0
        }

        function play(player){
            console.log(player);
            const playStr = ['가위','바위','보'];
            let com = randomNumber();
            let result = getWinner(player, com)
            console.log(result);
            /*if(result == 'win'){
                win++;
            }else if(result=='draw'){
                draw++;
            }else{
                lose++;
            }
            console.log(win,lose,draw);*/

            resultCount[result]++;
            console.log(resultCount);

            //결과 출력  \n = enter
            let str = `player:${playStr[player]} / com:${playStr[com]} => `;
            str += `player ${result}\n`;
            str += `현재 전적 \n`;
            str += `win:${resultCount.win} / draw:${resultCount.draw} / lose:${resultCount.lose}\n`;
            str += `승률 : ${getWinRate().toFixed(2)}%`;

            document.getElementById('result').innerText = str;
        }

        //승률을 계산하는 함수
        function getWinRate(){
            let sum = resultCount.win+resultCount.draw+resultCount.lose;
            return resultCount.win != 0 ?  
                (resultCount.win / (sum-resultCount.draw))*100 
                : 0;
        }

        // 랜덤 값을 리턴하는 함수
        function randomNumber(){
            return Math.floor(Math.random()*3);
        }

        // 승(win) 무(draw) 패(lose) 리턴하는 함수
        function getWinner(userChoice, comChoice){
            if(userChoice === comChoice){
                return 'draw';
            }else if(
                // 0=가위, 1=바위, 2=보
                (userChoice == 0 && comChoice == 2) ||
                (userChoice == 1 && comChoice == 0) ||
                (userChoice == 2 && comChoice == 1) 
            ){
                return 'win';
            }else {
                return 'lose';
            }
        }
    </script>
</body>
</html>